<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>會員註冊</title>

  <style>
    /* === 全域變數與基本樣式 === */
    :root {
      --maxw: 760px;         /* 頁面最大寬度 */
      --accent: #2563eb;     /* 主色（藍色） */
    }

    * { box-sizing: border-box; }

    body {
      font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Noto Sans TC', "Helvetica Neue", Arial;
      margin: 24px;
      background: #f7fafc;   /* 淺灰背景 */
      color: #0f172a;        /* 主文字顏色 */
    }

    /* === 主容器樣式 === */
    .container {
      max-width: var(--maxw);
      margin: 0 auto;
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 6px 18px rgba(15,23,42,0.06);
    }

    /* === 標題與段落 === */
    h1 {
      font-size: 1.5rem;
      margin: 0 0 12px;
    }
    p.lead {
      color: #64748b;
      margin-top: 0;
      margin-bottom: 18px;
    }

    /* === 表單結構 === */
    form {
      display: grid;
      gap: 12px; /* 各欄位間距 */
    }

    .row {
      display: flex;
      gap: 12px;
    }
    .col { flex: 1; } /* 兩欄平均寬 */

    label {
      display: block;
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 6px;
    }

    /* === 輸入欄位樣式 === */
    input[type=text],
    input[type=email],
    input[type=tel],
    input[type=password],
    select,
    textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #e6eef8;
      border-radius: 8px;
      font-size: 0.95rem;
    }

    /* === 提示文字與錯誤訊息 === */
    .hint {
      font-size: 0.85rem;
      color: #64748b;
      margin-top: 6px;
    }
    .error {
      color: #b91c1c; /* 紅色錯誤字 */
      font-size: 0.85rem;
      margin-top: 6px;
    }

    /* === 興趣勾選區塊 === */
    .checkboxes {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .checkboxes label { font-weight: 400; }

    /* === 按鈕與提示 === */
    .actions {
      display: flex;
      gap: 12px;
      align-items: center;
      margin-top: 6px;
    }
    button {
      background: var(--accent);
      color: white;
      border: none;
      padding: 10px 14px;
      border-radius: 10px;
      font-weight: 700;
      cursor: pointer;
    }
    button[disabled] {
      opacity: 0.6;
      cursor: not-allowed;
    }
    .small { font-size: 0.85rem; color: #475569; }

    /* === 成功訊息樣式 === */
    .success {
      background: #ecfdf5;
      border: 1px solid #bbf7d0;
      color: #065f46;
      padding: 10px;
      border-radius: 8px;
    }

    /* === 手機版響應式排版 === */
    @media (max-width:520px) {
      .row { flex-direction: column; }
    }
  </style>
</head>

<body>
  <div class="container" role="main">
    <h1>會員註冊</h1>
    <p class="lead">請填寫下列資訊建立帳號 —— 表單會即時驗證並防止重複送出。</p>

    <!-- 使用 HTML5 constraint validation API + 自訂錯誤提示 -->
    <form id="signupForm" novalidate>
      <!-- 姓名 -->
      <div>
        <label for="fullname">姓名（必填）</label>
        <input id="fullname" name="fullname" type="text" required minlength="2" placeholder="輸入姓名">
        <div class="hint" id="fullnameHint">請輸入真實姓名。</div>
        <div class="error" id="fullnameError" aria-live="polite"></div>
      </div>

      <!-- Email -->
      <div>
        <label for="email">Email（必填）</label>
        <input id="email" name="email" type="email" required placeholder="you@example.com">
        <div class="error" id="emailError" aria-live="polite"></div>
      </div>

      <!-- 手機 -->
      <div class="row">
        <div class="col">
          <label for="phone">手機（必填，10 碼）</label>
          <input id="phone" name="phone" type="tel" inputmode="numeric" pattern="^\d{10}$" required placeholder="09xxxxxxxx">
          <div class="hint">請輸入 10 位數字，例如 0912345678。</div>
          <div class="error" id="phoneError" aria-live="polite"></div>
        </div>
      </div>

      <!-- 密碼 + 確認密碼 -->
      <div class="row">
        <div class="col">
          <label for="password">密碼（至少 8 碼，含英數）</label>
          <input id="password" name="password" type="password" minlength="8" required placeholder="至少 8 個字元" aria-describedby="pwHint">
          <div class="hint" id="pwHint">建議含大小寫英文與數字，長度 ≥ 8。</div>
          <div class="error" id="passwordError" aria-live="polite"></div>
        </div>
        <div class="col">
          <label for="confirmPassword">確認密碼</label>
          <input id="confirmPassword" name="confirmPassword" type="password" required placeholder="再輸入一次密碼">
          <div class="error" id="confirmError" aria-live="polite"></div>
        </div>
      </div>

      <!-- 興趣勾選 -->
      <div>
        <label>興趣（至少勾選 1 個）</label>
        <div class="checkboxes" id="interests">
          <label><input type="checkbox" name="interest" value="tech"> 技術/程式</label>
          <label><input type="checkbox" name="interest" value="design"> 設計/美術</label>
          <label><input type="checkbox" name="interest" value="marketing"> 行銷</label>
          <label><input type="checkbox" name="interest" value="study"> 學習/課程</label>
          <label><input type="checkbox" name="interest" value="other"> 其他</label>
        </div>
        <div class="error" id="interestError" aria-live="polite"></div>
      </div>

      <!-- 同意條款 -->
      <div>
        <label><input id="terms" name="terms" type="checkbox" required> 我已閱讀並同意服務條款（必填）</label>
        <div class="error" id="termsError" aria-live="polite"></div>
      </div>

      <!-- 送出區域 -->
      <div class="actions">
        <button type="submit" id="submitBtn">註冊</button>
        <div class="small" id="busyMsg" aria-live="polite" style="display:none">處理中…</div>
      </div>

      <!-- 成功結果訊息 -->
      <div id="result" style="display:none;margin-top:12px"></div>
    </form>
  </div>

  <script>
    /* === 抓取表單元素 === */
    const form = document.getElementById('signupForm');
    const submitBtn = document.getElementById('submitBtn');
    const busyMsg = document.getElementById('busyMsg');

    // 錯誤訊息元素集中管理
    const errors = {
      fullname: document.getElementById('fullnameError'),
      email: document.getElementById('emailError'),
      phone: document.getElementById('phoneError'),
      password: document.getElementById('passwordError'),
      confirm: document.getElementById('confirmError'),
      interest: document.getElementById('interestError'),
      terms: document.getElementById('termsError')
    };

    /* === 密碼強度條 === */
    const passwordField = document.getElementById('password');
    const pwHint = document.getElementById('pwHint');
    const strengthBar = document.createElement('div'); // 動態新增進度條
    strengthBar.style.height = '6px';
    strengthBar.style.borderRadius = '4px';
    strengthBar.style.marginTop = '6px';
    pwHint.insertAdjacentElement('afterend', strengthBar);

    // 顯示錯誤訊息
    function showError(field, message) {
      errors[field].textContent = message || '';
    }

    // 密碼強度判斷：依條件加分
    function checkPasswordStrength(pw) {
      let strength = 0;
      if (pw.length >= 8) strength++;
      if (/[A-Z]/.test(pw)) strength++;
      if (/[a-z]/.test(pw)) strength++;
      if (/\d/.test(pw)) strength++;
      if (/[^A-Za-z0-9]/.test(pw)) strength++; // 特殊字元
      return strength;
    }

    // 更新強度條顯示
    function updateStrengthBar(pw) {
      const s = checkPasswordStrength(pw);
      const levels = ['弱','中','強','很強','極強'];
      const colors = ['#ef4444','#f97316','#eab308','#22c55e','#16a34a'];
      const idx = Math.min(s-1, 4);

      if (pw.length === 0) {
        strengthBar.style.background = 'transparent';
        strengthBar.style.width = '0';
        pwHint.textContent = '建議含大小寫英文、數字與特殊字元，長度 ≥ 8。';
      } else {
        strengthBar.style.width = (s * 20) + '%';
        strengthBar.style.background = colors[idx];
        pwHint.textContent = `密碼強度：${levels[idx]}`;
      }
    }

    // 密碼輸入時即時更新強度
    passwordField.addEventListener('input', e => {
      updateStrengthBar(e.target.value);
      validateField('password');
    });

    /* === 驗證單一欄位 === */
    function validateField(name) {
      const f = form.elements[name];
      if (!f) return true;

      // 手機驗證（10位數）
      if (name === 'phone') {
        const ok = /^\d{10}$/.test(f.value.trim());
        showError('phone', ok ? '' : '請輸入 10 位數字（例：0912345678）');
        return ok;
      }

      // 密碼格式驗證
      if (name === 'password') {
        const v = f.value;
        const ok = v.length >= 8 && /[A-Za-z]/.test(v) && /\d/.test(v);
        showError('password', ok ? '' : '密碼需 ≥8 且包含英文字母與數字。');
        return ok;
      }

      // 確認密碼一致性
      if (name === 'confirmPassword') {
        const pw = form.elements['password'].value;
        const ok = (f.value === pw);
        showError('confirm', ok ? '' : '兩次密碼不相符。');
        return ok;
      }

      // Email 格式驗證（利用 HTML5 自帶）
      if (name === 'email') {
        const ok = f.checkValidity();
        showError('email', ok ? '' : '請輸入有效的 Email。');
        return ok;
      }

      // 姓名最少2字
      if (name === 'fullname') {
        const ok = f.value.trim().length >= 2;
        showError('fullname', ok ? '' : '姓名至少 2 個字元。');
        return ok;
      }

      // 是否同意條款
      if (name === 'terms') {
        const ok = form.elements['terms'].checked;
        showError('terms', ok ? '' : '必須同意服務條款。');
        return ok;
      }

      return true;
    }

    // 驗證興趣是否至少勾選一項
    function validateInterests() {
      const checked = Array.from(document.querySelectorAll('input[name="interest"]'))
                          .some(cb => cb.checked);
      showError('interest', checked ? '' : '請至少選擇一個興趣。');
      return checked;
    }

    /* === 即時驗證事件 === */
    form.addEventListener('input', (e) => {
      const name = e.target.name;
      if (['fullname','email','phone','password','confirmPassword','terms'].includes(name)) {
        validateField(name);
      }
      if (e.target.name === 'interest') {
        validateInterests();
      }
    });

    /* === 禁止 Enter 自動送出（非 textarea）=== */
    form.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && e.target.tagName !== 'TEXTAREA') {
        e.preventDefault();
      }
    });

    /* === 表單送出 === */
    form.addEventListener('submit', async (e) => {
      e.preventDefault(); // 防止預設送出
      Object.keys(errors).forEach(k => showError(k, '')); // 清空舊錯誤

      // 先用 HTML5 自帶檢查
      if (!form.checkValidity()) {
        ['fullname','email','phone','password','confirmPassword','terms'].forEach(name => validateField(name));
        validateInterests();
        return;
      }

      // 自訂邏輯再檢查一次
      const okPw = validateField('password');
      const okConfirm = validateField('confirmPassword');
      const okPhone = validateField('phone');
      const okInterests = validateInterests();
      const okTerms = validateField('terms');

      if (!(okPw && okConfirm && okPhone && okInterests && okTerms)) return;

      // 顯示「處理中」
      submitBtn.disabled = true;
      busyMsg.style.display = 'inline';

      try {
        // 模擬伺服器請求
        await fakeNetworkRequest();

        // 成功訊息
        const result = document.getElementById('result');
        result.style.display = 'block';
        result.className = 'success';
        result.textContent = '註冊成功！已寄送確認信至 ' + form.elements['email'].value;

        // 清空表單
        form.reset();
        updateStrengthBar(''); // 重置強度條
      } catch (err) {
        alert('送出失敗：' + err.message);
      } finally {
        submitBtn.disabled = false;
        busyMsg.style.display = 'none';
      }
    });

    /* === 模擬網路延遲 === */
    function fakeNetworkRequest() {
      return new Promise((res) => setTimeout(res, 700 + Math.random() * 600));
    }

    // 載入後自動聚焦姓名欄位
    document.getElementById('fullname').focus();
  </script>
</body>
</html>


